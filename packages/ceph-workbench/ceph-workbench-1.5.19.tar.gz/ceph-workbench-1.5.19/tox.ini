[tox]
envlist = flake8,py27,py3
skip_missing_interpreters = True

[testenv]
setenv =
       VIRTUAL_ENV={envdir}
       PYTHONPATH={toxinidir}/teuthology
passenv = HOME OS_REGION_NAME OS_AUTH_URL OS_TENANT_ID OS_TENANT_NAME OS_PASSWORD OS_USERNAME TEST_*
usedevelop = true
deps = -r{toxinidir}/requirements.txt
whitelist_externals = *
commands = env \
         PATH={toxinidir}/teuthology/virtualenv/bin:{env:PATH} \
         {envbindir}/coverage run --source=ceph_workbench \
         {envbindir}/py.test -v {posargs:tests}
         {envbindir}/coverage combine .tox # use coverage information retrieved from remote hosts
         {envbindir}/coverage report --omit=*test*,*tox*,*wbbackport.py,*wbgitlab.py --show-missing # --fail-under=100

[testenv:flake8]
commands = flake8 --ignore=H105,H405 bin ceph_workbench tests
