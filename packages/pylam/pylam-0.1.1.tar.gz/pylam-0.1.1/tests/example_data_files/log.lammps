LAMMPS (14 May 2016)
#==============================================================================
# Cubic system with NXmol^3 Bmim Br molecules
#==============================================================================

# define variables
#------------------------------------------------------------------------------
variable    NXmol equal 40
variable    T     equal 320
variable    dens  equal 1.3000

variable    dt_def  equal 1.0
variable    st_def  equal 1000
variable    dt_nvt  equal 1.0
variable    st_nvt  equal 1000

# calc values
#------------------------------------------------------------------------------
variable    NmolSet equal (${NXmol})^3
variable    NmolSet equal (40)^3

# setup system
#------------------------------------------------------------------------------
units           real
boundary        p p p
atom_style      full
pair_style      lj/cut/coul/long 16.0
bond_style      harmonic
angle_style     harmonic
dihedral_style  opls
improper_style  harmonic
pair_modify     mix arithmetic
kspace_style    pppm 1.0e-5
neigh_modify    delay 0 every 1 check no once no page 500000 one 15000
special_bonds   lj/coul 0.0 0.0 0.5
read_data       bmimbr.data
  orthogonal box = (-8 -4 -6) to (6 8 8)
  4 by 4 by 4 MPI processor grid
  reading atoms ...
  26 atoms
  scanning bonds ...
  3 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  10 = max dihedrals/atom
  scanning impropers ...
  1 = max impropers/atom
  reading bonds ...
  25 bonds
  reading angles ...
  45 angles
  reading dihedrals ...
  59 dihedrals
  reading impropers ...
  5 impropers
  4 = max # of 1-2 neighbors
  7 = max # of 1-3 neighbors
  14 = max # of 1-4 neighbors
  16 = max # of special neighbors
replicate       ${NXmol} ${NXmol} ${NXmol}
replicate       40 ${NXmol} ${NXmol}
replicate       40 40 ${NXmol}
replicate       40 40 40
  orthogonal box = (-8 -4 -6) to (552 476 554)
  4 by 4 by 4 MPI processor grid
  1664000 atoms
  1600000 bonds
  2880000 angles
  3776000 dihedrals
  320000 impropers
  4 = max # of 1-2 neighbors
  7 = max # of 1-3 neighbors
  14 = max # of 1-4 neighbors
  16 = max # of special neighbors

# calc values
#------------------------------------------------------------------------------
variable    pre_box equal (mass(all)/(6.022141E23*${dens}))^(1/3)*100000000
variable    pre_box equal (mass(all)/(6.022141E23*1.3))^(1/3)*100000000
variable    V equal vol
variable    atoms equal count(all)
variable    st_def2 equal ceil(${st_def}/2)
variable    st_def2 equal ceil(1000/2)

# write info file
#------------------------------------------------------------------------------
print "# BmimBr cubic " file info.dat screen no
print "Nmol=${NmolSet}" append info.dat screen no
print "T=${T}" append info.dat screen no
print "dens=${dens}" append info.dat screen no
print "dt_def=${dt_def}" append info.dat screen no
print "st_def=${st_def}" append info.dat screen no
print "dt_nvt=${dt_nvt}" append info.dat screen no
print "st_nvt=${st_nvt}" append info.dat screen no


# init. prep. run (->density)
#==============================================================================
timestep    ${dt_def}
timestep    1
velocity    all create $T 1025 dist gaussian
velocity    all create 320 1025 dist gaussian
thermo_style custom step temp etotal pe ke epair press vol
thermo      100

#dump        TRAJ all atom 100 traj.dump

fix VSCALE  all temp/rescale 1 $T $T 1.0 1.0
fix VSCALE  all temp/rescale 1 320 $T 1.0 1.0
fix VSCALE  all temp/rescale 1 320 320 1.0 1.0
fix NVE all nve
fix DEF all deform 1 x final 0.0 ${pre_box} y final 0.0 ${pre_box} z final 0.0 ${pre_box} units box
fix DEF all deform 1 x final 0.0 261.653254698726 y final 0.0 ${pre_box} z final 0.0 ${pre_box} units box
fix DEF all deform 1 x final 0.0 261.653254698726 y final 0.0 261.653254698726 z final 0.0 ${pre_box} units box
fix DEF all deform 1 x final 0.0 261.653254698726 y final 0.0 261.653254698726 z final 0.0 261.653254698726 units box

run ${st_def2}
run 500
PPPM initialization ...
WARNING: Using 12-bit tables for long-range coulomb (../kspace.cpp:316)
  G vector (1/distance) = 0.15258
  grid = 144 125 144
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00380464
  estimated relative force accuracy = 1.14576e-05
  using double precision FFTs
  3d grid and FFT values/proc = 62197 54000
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check no
  max neighbors/atom: 15000, page size: 500000
  master list distance cutoff = 18
  ghost atom cutoff = 18
  binsize = 9 -> bins = 63 54 63
Memory usage per processor = 58.7613 Mbytes
Step Temp TotEng PotEng KinEng E_pair Press Volume 
       0          320    4505820.3    2918599.5    1587220.8   -1762090.4   -4882.8427  1.50528e+08 
     100          320    43247.533   -1543973.2    1587220.8   -2581246.5    1205.7821 1.0922698e+08 
     200          320   -162450.05   -1749670.8    1587220.8   -3074708.2    1948.0351     76247907 
     300          320   -756557.08   -2343777.9    1587220.8   -3485240.4   -6451.5278     50657881 
     400          320   -1310017.8   -2897238.6    1587220.8   -3836378.6    14537.475     31524014 
     500          320   -1002314.2     -2589535    1587220.8   -3794575.9    52635.664     17913417 
Loop time of 1142.09 on 64 procs for 500 steps with 1664000 atoms

Performance: 0.038 ns/day, 634.494 hours/ns, 0.438 timesteps/s
93.0% CPU use with 64 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 144.79     | 149.62     | 153.95     |  17.4 | 13.10
Bond    | 16.294     | 16.504     | 17.38      |   4.7 |  1.45
Kspace  | 621.19     | 626.01     | 630.98     |   9.0 | 54.81
Neigh   | 261.86     | 262.18     | 262.44     |   1.0 | 22.96
Comm    | 66.306     | 71.848     | 75.624     |  30.6 |  6.29
Output  | 0.054085   | 0.076193   | 0.089217   |   4.2 |  0.01
Modify  | 11.62      | 15.304     | 20.772     |  65.9 |  1.34
Other   |            | 0.5473     |            |       |  0.05

Nlocal:    26000 ave 26042 max 25969 min
Histogram: 5 3 6 14 18 5 7 5 0 1
Nghost:    71542.1 ave 71635 max 71402 min
Histogram: 1 0 3 5 7 13 18 7 7 3
Neighs:    2.92454e+07 ave 2.96026e+07 max 2.87909e+07 min
Histogram: 4 4 5 4 5 6 13 16 3 4

Total # of neighbors = 1871708519
Ave neighs/atom = 1124.82
Ave special neighs/atom = 9.53846
Neighbor list builds = 500
Dangerous builds not checked

unfix DEF

run ${st_def2}
run 500
PPPM initialization ...
WARNING: Using 12-bit tables for long-range coulomb (../kspace.cpp:316)
  G vector (1/distance) = 0.168168
  grid = 90 90 90
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00306518
  estimated relative force accuracy = 9.2307e-06
  using double precision FFTs
  3d grid and FFT values/proc = 21952 16200
Memory usage per processor = 79.6793 Mbytes
Step Temp TotEng PotEng KinEng E_pair Press Volume 
     500          320   -917436.86   -2504657.6    1587220.8   -3737160.3    58623.752     17913417 
     600          320   -2850052.3     -4437273    1587220.8   -5160085.5    28110.966     17913417 
     700          320     -2842650   -4429870.7    1587220.8   -5138552.4    17013.451     17913417 
     800    320.94338   -2698070.1   -4289970.1      1591900   -5166507.7    16168.381     17913417 
     900    319.31876   -2730373.7   -4314215.5    1583841.8   -5229277.8    16105.854     17913417 
    1000    320.65987   -2714195.3   -4304689.1    1590493.8   -5257599.1    15469.057     17913417 
Loop time of 1704.22 on 64 procs for 500 steps with 1664000 atoms

Performance: 0.025 ns/day, 946.791 hours/ns, 0.293 timesteps/s
96.7% CPU use with 64 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 423.95     | 445.11     | 483.36     |  55.9 | 26.12
Bond    | 16.999     | 18.253     | 27.9       |  49.4 |  1.07
Kspace  | 236.6      | 284.58     | 306.92     |  79.3 | 16.70
Neigh   | 839.69     | 840.05     | 840.49     |   0.7 | 49.29
Comm    | 94.092     | 102.79     | 111.09     |  48.6 |  6.03
Output  | 0.052501   | 0.055788   | 0.058578   |   0.5 |  0.00
Modify  | 4.6126     | 12.717     | 21.313     | 135.8 |  0.75
Other   |            | 0.6683     |            |       |  0.04

Nlocal:    26000 ave 26072 max 25916 min
Histogram: 2 2 8 4 16 6 8 8 6 4
Nghost:    71138.1 ave 71375 max 70981 min
Histogram: 3 9 7 18 9 6 8 2 1 1
Neighs:    2.94554e+07 ave 2.97901e+07 max 2.9031e+07 min
Histogram: 5 6 3 3 5 8 10 11 9 4

Total # of neighbors = 1885146675
Ave neighs/atom = 1132.9
Ave special neighs/atom = 9.53846
Neighbor list builds = 500
Dangerous builds not checked

unfix VSCALE
unfix NVE


# NVT run
#==============================================================================
timestep    ${dt_nvt}
timestep    1
fix         NVT all nvt temp $T $T 100
fix         NVT all nvt temp 320 $T 100
fix         NVT all nvt temp 320 320 100
run         ${st_nvt}
run         1000
PPPM initialization ...
WARNING: Using 12-bit tables for long-range coulomb (../kspace.cpp:316)
  G vector (1/distance) = 0.168168
  grid = 90 90 90
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00306518
  estimated relative force accuracy = 9.2307e-06
  using double precision FFTs
  3d grid and FFT values/proc = 21952 16200
Memory usage per processor = 79.6793 Mbytes
Step Temp TotEng PotEng KinEng E_pair Press Volume 
    1000    320.65987   -2714195.3   -4304689.1    1590493.8   -5257599.1    15469.057     17913417 
    1100    320.56826   -2715126.9   -4305166.3    1590039.4   -5290368.6    12739.825     17913417 
    1200    320.48446   -2718390.5   -4308014.2    1589623.7   -5320414.6    11836.035     17913417 
    1300    320.67353   -2720969.6   -4311531.1    1590561.5   -5346575.4    11456.596     17913417 
    1400    320.47172   -2724899.8   -4314460.4    1589560.6     -5370095    10808.665     17913417 
    1500    320.53113   -2728968.2   -4318823.4    1589855.2     -5392222    10737.763     17913417 
    1600    320.30622   -2733482.1   -4322221.7    1588739.6   -5412472.1     10433.14     17913417 
    1700    320.57771   -2738015.5   -4328101.8    1590086.3     -5432710    10138.377     17913417 
    1800    320.75326   -2743207.7   -4334164.7      1590957   -5451655.5    9602.3808     17913417 
    1900    320.74619   -2748426.7   -4339348.7    1590921.9   -5470106.4    9174.7626     17913417 
    2000    320.34515   -2753670.5   -4342603.2    1588932.7   -5484580.3    8819.8374     17913417 
Loop time of 3628.8 on 64 procs for 1000 steps with 1664000 atoms

Performance: 0.024 ns/day, 1008.000 hours/ns, 0.276 timesteps/s
96.7% CPU use with 64 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 879.42     | 927.04     | 1076       | 102.6 | 25.55
Bond    | 34.513     | 37.393     | 63.599     |  79.6 |  1.03
Kspace  | 473.6      | 648.53     | 698.79     | 139.0 | 17.87
Neigh   | 1782.8     | 1783.7     | 1784.3     |   1.0 | 49.15
Comm    | 188.32     | 205.32     | 221.47     |  67.6 |  5.66
Output  | 0.10584    | 0.11175    | 0.11505    |   0.7 |  0.00
Modify  | 9.0866     | 25.441     | 42.188     | 189.5 |  0.70
Other   |            | 1.303      |            |       |  0.04

Nlocal:    26000 ave 26128 max 25891 min
Histogram: 5 5 6 9 8 11 12 4 3 1
Nghost:    71052.5 ave 71233 max 70802 min
Histogram: 2 2 3 7 5 16 10 6 9 4
Neighs:    2.94763e+07 ave 2.98905e+07 max 2.89447e+07 min
Histogram: 3 1 3 7 8 14 8 10 9 1

Total # of neighbors = 1886480729
Ave neighs/atom = 1133.7
Ave special neighs/atom = 9.53846
Neighbor list builds = 1000
Dangerous builds not checked
write_data  restart.data
PPPM initialization ...
WARNING: Using 12-bit tables for long-range coulomb (../kspace.cpp:316)
  G vector (1/distance) = 0.168168
  grid = 90 90 90
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00306518
  estimated relative force accuracy = 9.2307e-06
  using double precision FFTs
  3d grid and FFT values/proc = 21952 16200


Total wall time: 1:48:29
