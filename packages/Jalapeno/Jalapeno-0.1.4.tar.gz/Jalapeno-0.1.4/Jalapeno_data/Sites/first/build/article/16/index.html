<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset='utf-8'>
        <title>
数据可视化(2)：五种基本图形
|| 老钱</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel='stylesheet' href='/static/css/normalize.css'>
		<link rel='stylesheet' href="/static/css/mono.css">
		<link rel='stylesheet' href='/static/css/bootstrap.css'>
		<link rel='stylesheet' media="screen and (min-width:1023px)"  href='/static/css/homepage.css'>
		<link rel='stylesheet' media="screen and (max-width:1023px)"  href='/static/icss/ihomepage.css'>
        

<link rel='stylesheet' media="screen and (min-width:1025px)"  href='/static/css/article.css'>


<link rel='stylesheet' media="screen and (max-width:1024px)"  href='/static/icss/iarticle.css'>


        
        <script src="https://carnivalapp.io/sites/559/init.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", Carnival.init);
</script>
        
                 <script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-83291137-1', 'auto');
              ga('send', 'pageview');

        </script> 
        
        <script type="text/javascript" src="http://assets.vicomi.com/assets/widgets_static.js"></script>


<script>
(function() {
var v = document.createElement('script'); v.async = true;
v.src = "http://assets.vicomi.com/assets/widgets_static.js";
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(v, s);
})();
</script> 
        

    
    
    </head>
    
    <body>
        <div id="wrapper">
        <div id='main-page'>
           <div class="mask"></div>
            <header>
                <nav>
                    <div class="logo"><a href="/">老钱</a></div>
                    <button class="menu_trigger">☰</button>
                    <ul class="menu">
                        
                           
                        <li><a href='/'>文章</a></li> 
<!--
                        <li><a href='#'>归档</a></li> 
                        <li><a href='#'>关于</a></li>     
-->
                    </ul>
                    
                </nav>
                <div class="hr"></div>
            </header>
            <div class='content'>
                <div class="content_wrapper">
                    
    <div class="article_header">
        <h1 class="article_title"><a>数据可视化(2)：五种基本图形</a></h1>                   
		<div class="article_info">2016-11-24 | 分类于:  <a class = 'tag' href="/tag/Python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">Python数据可视化</a></div>
	</div>
	<article>
        
        

<p>上一次通过一个简单例子学习了图形的基本绘制方法，这次我们通过农企(AMD)的数据来学习五种基本图形的绘制</p>
<h2 id="_1">工具准备</h2>
<ul>
<li>AMD股票数据(Nov 21,2015 - Nov 21,2016),<a href="http://chart.finance.yahoo.com/table.csv?s=AMD&amp;a=10&amp;b=21&amp;c=2015&amp;d=10&amp;e=21&amp;f=2016&amp;g=d&amp;ignore=.csv">下载</a></li>
<li>S&amp;P500同期指数，<a href="http://chart.finance.yahoo.com/table.csv?s=^GSPC&amp;a=10&amp;b=21&amp;c=2015&amp;d=10&amp;e=21&amp;f=2016&amp;g=d&amp;ignore=.csv">下载</a></li>
<li>AMD最近四个季度的财报</li>
<li>S&amp;P500 同时段（AMD)的指数
<!--More--></li>
<li>Numpy</li>
<li>Matplotlib</li>
<li>Python3.x</li>
</ul>
<p>(数据来源:Yahoo Finance）</p>
<p>首先我们引入工具</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>


<p>接着使用loadtxt导入文件,我们的文件看上去是这个样子的</p>
<p><img alt="" src="/image/16/data.png" />
......</p>
<p>numpy可以很快地将现有的csv类型的数据导入</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">date</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;Nov21-1yr.csv&#39;</span><span class="p">,</span><span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">converters</span> <span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="n">bytespdate2num</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)},</span><span class="n">skiprows</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>导入文件名 Nov21-1yr.csv</li>
<li>delimiter 分隔符为','</li>
<li>converters 如果有日期需要使用bytespdate2num解析内容，0代表第一列</li>
<li>skiprows =1 跳过第一行</li>
<li>usecols(0,2,3) 使用1,3,4行，值得注意的是，如果我们只要获取一行，要用元组表示：usecols（x,)</li>
<li>unpack 将提取的数据分别放在三个列表里</li>
</ul>
<h2 id="_2">散点图</h2>
<h3 id="_3">简介</h3>
<blockquote>
<p>用两组数据构成多个坐标点，考察坐标点的分布，判断两变量之间是否存在某种关联或总结坐标点的分布模式。散点图将序列显示为一组点。值由点在图表中的位置表示。类别由图表中的不同标记表示。散点图通常用于比较跨类别的聚合数据。(<a href="http://baike.baidu.com/view/1323662.htm">百度百科</a>)</p>
</blockquote>
<p>使用scatter函数,array1（x轴）,array2（y轴)为两组数据</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">array1</span><span class="p">,</span><span class="n">array2</span><span class="p">,[</span><span class="n">parameters</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<h3 id="_4">实例</h3>
<p>首先我们获得AMD最近一年的最高价格，最低价格，日期</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">date</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;Nov21-1yr.csv&#39;</span><span class="p">,</span><span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">converters</span> <span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="n">bytespdate2num</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)},</span><span class="n">skiprows</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>获得每日的价格波动范围,通过numpy读取的数据拥有array的格式，可以对两个同样大小的列表直接进行加减</p>
<div class="codehilite"><pre><span></span><span class="gh">diff = high -low</span>
</pre></div>


<p>接着我们使用scatter函数作散点图</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="n">diff</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>这里的alpha是透明度。添加了透明度属性后，颜色会变淡，而重合的点的颜色会加深，使散点图更加直观</p>
<blockquote>
<p>>>> <strong>plt.show()</strong></p>
</blockquote>
<p><img alt="" src="/image/16/scatter.png" /></p>
<h2 id="_5">折线图</h2>
<h3 id="_6">简介</h3>
<blockquote>
<p>折线图是排列在工作表的列或行中的数据可以绘制到折线图中。折线图可以显示随时间（根据常用比例设置）而变化的连续数据，因此非常适用于显示在相等时间间隔下数据的趋势。在折线图中，类别数据沿水平轴均匀分布，所有值数据沿垂直轴均匀分布。(<a href="http://baike.baidu.com/view/1396532.htm">百度百科</a>)</p>
</blockquote>
<p>使用plot函数,array1（x轴）,array2（y轴)为两组数据</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array1</span><span class="p">,</span><span class="n">array2</span><span class="p">,[</span><span class="n">parameters</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<p>如果需要表示日期，使用plot_date</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot_date</span><span class="p">(</span><span class="n">date_array1</span><span class="p">,</span><span class="n">array2</span><span class="p">,[</span><span class="n">parameters</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<h3 id="1amd">实例1：AMD股票走势</h3>
<p>我们这里使用农企一年的股票走势来举例,首先我们先获取收盘价和日期</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">date</span><span class="p">,</span><span class="n">close</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;Nov21-1yr.csv&#39;</span><span class="p">,</span><span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">converters</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="n">bytespdate2num</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)},</span><span class="n">skiprows</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>接着我们用获得的数据来绘制折线图。正常情况下我们应该使用plot函数。但是由于我们涉及日期，为了更好地展现我们的图标。我们使用plot_date函数</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot_date</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="n">close</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">markersize</span> <span class="o">=</span><span class="mf">2.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#147FB1&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AMD&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>linestyle： 这里规定折线线段的种类。使用plot_date时，默认为圆点（类似散点图)，所以我们使用'-'代表线段</li>
<li>markersize：这是图中每一个圆点的大小，当markersize和线段粗细相同时无法显示</li>
</ul>
<blockquote>
<p>>>> <strong>plt.show()</strong></p>
</blockquote>
<p><img alt="" src="/image/16/line.png" /></p>
<h3 id="2sp500">实例2:S&amp;P500走势</h3>
<p>动手试试用同样的办法来绘制S&amp;P500最近一年(Nov 21,2015 - Nov 21,2016)的走势</p>
<p><img alt="" src="/image/16/sp500.png" /></p>
<h3 id="sp500amd">比较S&amp;P500与AMD</h3>
<p>如果我们直接进行S&amp;P500和农企的比较，会发现农企是一条贴近X轴的线（AMD是个位数，S&amp;P是4位数）。所以在我们需要将S&amp;P500的值缩小比例，具体方法是先求出每日的变化率，然后使用同一起点（AMD第一天的收盘价），根据变化率来模拟走势</p>
<p>这里我们需要两个S&amp;P500的变量:spopen,spclose；和两个之前AMD的变量close,date</p>
<p>首先我们求出每日的变化率，得到一年的变化率列表</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">#（收盘价-开盘价）/开盘价</span>
<span class="n">spchanges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">spclose</span><span class="o">-</span><span class="n">spopen</span><span class="p">,</span><span class="n">spopen</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>接着是一个缩小比例的函数,假设第一天的收盘价（指数）作为第二天的开盘价（指数），接收一个起点价格和从该点开始一年的变动</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sp500_scale_down</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span><span class="n">changes</span><span class="p">):</span>
    <span class="n">stdsp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">changes</span><span class="p">:</span>
        <span class="n">start_point</span> <span class="o">=</span> <span class="n">start_point</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">each</span><span class="p">)</span>
        <span class="n">stdsp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start_point</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stdsp</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>看看我们如何调用这个函数</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">stdsp</span> <span class="o">=</span> <span class="n">sp500_scale_down</span><span class="p">(</span><span class="n">close</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">spchanges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="n">spchanges</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<p>这时我们获得了一个缩小版的S&amp;P500指数列表stdsp。注意我们这个列表的内容都是从后往前的，即close[0]代表的是Nov 21，2016这一天而不是最靠前的Nov 21，2015.所以我们的第一天其实是列表的最后一个，即close[-1],spchanges同理。 而[::-1]表示反转列表，将其变回正常顺序。</p>
<p>绘制农企和S&amp;P500的走势</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot_date</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="n">close</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">markersize</span> <span class="o">=</span><span class="mf">2.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#147FB1&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AMD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot_date</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="n">stdsp</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">markersize</span> <span class="o">=</span><span class="mf">2.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#14B158&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;S&amp;P500&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>为什么我们的stdsp要在这里反转呢？因为我们之前提到过我们提取的数据是从后往前的，可是，<strong>我们画出来的数据方向不是反的</strong>,这说明plot_date函数接收一个“反”着的列表，而我们的stdsp列表是从前往后推的，我们需要将其反转</p>
<p>绘制图例</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<blockquote>
<p>>>> <strong>plt.show()</strong></p>
</blockquote>
<p><img alt="" src="/image/16/linecompare.png" /></p>
<h2 id="_7">条形图</h2>
<h3 id="_8">简介</h3>
<blockquote>
<p>排列在工作表的列或行中的数据可以绘制到条形图中。条形图显示各个项目之间的比较情况。(<a href="http://baike.baidu.com/item/%E6%9D%A1%E5%BD%A2%E5%9B%BE">百度百科</a>)</p>
</blockquote>
<p>绘制条形图，我们需要bar函数（纵向)或barh函数(横向),x_array代表分布在x轴的点，y_array代表高度</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">x_array</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">y_array</span><span class="p">,[</span><span class="n">parameters</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<h3 id="amd4">条形图实例：AMD4个季度营业额</h3>
<p>首先我们获取农企最近四个季度的营业额，我们可以到AMD的官网，SEC里EDGAR的10Q或者其他第三方网站（Yahoo Finance)中找到</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">#单位：&#39;M(百万)&#39;</span>
<span class="n">revenue</span> <span class="o">=</span> <span class="p">[</span><span class="mi">958</span><span class="p">,</span><span class="mi">832</span><span class="p">,</span><span class="mi">1207</span><span class="p">,</span><span class="mi">1307</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>接着生成四个条形图的位置列表</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">#数量4个</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1">#生成x轴坐标列表[0,1.5,3.0,4.5]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span>
</pre></div>
</td></tr></table>

<p>使用bar函数来绘制条形图</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">revenue</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span><span class="s1">&#39;#51ADD8&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>left 表示条形图在x轴的位置，以条形图左下角的点为坐标点</li>
<li>width 表示条形图的宽度</li>
<li>height 表示条形图高度</li>
<li>align='center' 文字居中</li>
</ul>
<p>接着使用日期来标记，分别是四个季度出财报（10-Q)的日期,并定位</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">x_date</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;12/26/2015&#39;</span><span class="p">,</span><span class="s1">&#39;3/26/2016&#39;</span><span class="p">,</span><span class="s1">&#39;6/25/2016&#39;</span><span class="p">,</span><span class="s1">&#39;9/24/2016&#39;</span><span class="p">]</span>
<span class="n">x_namepos</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_namepos</span><span class="p">,</span><span class="n">x_date</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<blockquote>
<p>>>> <strong>plt.show()</strong></p>
</blockquote>
<p><img alt="" src="/image/16/bar.png" /></p>
<h3 id="_9">条形图（横向）实例</h3>
<p>前面我们知道了一个标准的条形图该如何绘制，有的时候我们会想要使用横向的条形图该怎么办，和bar差不多，matplotlib在这里提供了barh函数</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span><span class="s1">&#39;#51ADD8&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">revenue</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>bottom 表示条形图在y轴的位置，以条形图左上角的点为坐标点</li>
<li>width 横过来表示长度</li>
<li>height 竖过来表示宽度</li>
</ul>
<blockquote>
<p>>>> <strong>plt.show()</strong></p>
</blockquote>
<p><img alt="" src="/image/16/barh.png" /></p>
<h3 id="_10">条形图对比实例</h3>
<p>除了营业额，我们还可以来看一下两个条形图如何在一起对比，这里我们增加了农企的四个季度净利润</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">#单位：&#39;M(百万)&#39;</span>
<span class="n">income</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">102</span><span class="p">,</span><span class="o">-</span><span class="mi">109</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="o">-</span><span class="mi">406</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>之前我们设定了两个营业额条形图间距为1.5，添加了净额之后我们预期的结构是这样的</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mf">0.5</span><span class="p">:</span><span class="err">营业额</span><span class="mi">1</span>
<span class="mf">0.5</span><span class="err">：净额</span><span class="mi">1</span>
<span class="mf">0.5</span><span class="p">:</span><span class="err">间距</span>
<span class="mf">0.5</span><span class="p">:</span><span class="err">营业额</span><span class="mi">2</span>
</pre></div>
</td></tr></table>

<p>所以绘制净额</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">income</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span><span class="s1">&#39;#51ADD8&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Net Income&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>left 在营业额的坐标点增加0.5(营业额width)</li>
</ul>
<p>添加日期，图例</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">x_datepos</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">x_date</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;12/26/2015&#39;</span><span class="p">,</span><span class="s1">&#39;3/26/2016&#39;</span><span class="p">,</span><span class="s1">&#39;6/25/2016&#39;</span><span class="p">,</span><span class="s1">&#39;9/24/2016&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_datepos</span><span class="p">,</span><span class="n">x_date</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<blockquote>
<p>>>> <strong>plt.show()</strong></p>
</blockquote>
<p><img alt="" src="/image/16/twobars.png" /></p>
<h2 id="_11">直方图</h2>
<h3 id="_12">简介</h3>
<blockquote>
<p>直方图(Histogram)又称质量分布图。是一种统计报告图，由一系列高度不等的纵向条纹或线段表示数据分布的情况。 一般用横轴表示数据类型，纵轴表示分布情况。(<a href="http://baike.baidu.com/item/%E7%9B%B4%E6%96%B9%E5%9B%BE/1103834">百科词条</a>)</p>
</blockquote>
<p>绘制直方图我们使用hist函数,array表示变量集合,bins代表分布数量</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,[</span><span class="n">parameters</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<h3 id="amd">实例：AMD股价变化率正态分布</h3>
<p>获取股票价格</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">open_price</span><span class="p">,</span><span class="n">close_price</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;Nov21-1yr.csv&#39;</span><span class="p">,</span><span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">skiprows</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>获取变化率，使用百分比（乘以100）</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">diff</span> <span class="o">=</span> <span class="p">((</span><span class="n">close_price</span><span class="o">-</span><span class="n">open_price</span><span class="p">)</span><span class="o">/</span><span class="n">open_price</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</td></tr></table>

<p>绘制直方图，分30个连续的区间，并使用正态分布</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EA4545&#39;</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<blockquote>
<p>>>> <strong>plt.show()</strong></p>
</blockquote>
<p><img alt="" src="/image/16/hist.png" /></p>
<h2 id="_13">饼图</h2>
<blockquote>
<p>扇形统计图是用整个圆表示总数，用圆内各个扇形的大小表示各部分数量占总数的百分数。通过扇形统计图可以很清楚地表示出各部分数量同总数之间的关系。百分数.。　扇形统计图可以清楚地表示各个项目与总数之间的关系。(<a href="http://baike.baidu.com/subview/1289/1289.htm">百科词条</a>)</p>
</blockquote>
<p>绘制饼图很简单，我们只需要使用pie函数和一组数据即可完成</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">fracs</span><span class="p">,[</span><span class="n">parameters</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<h3 id="amd_1">实例：AMD资产结构</h3>
<p>我们先找到农企2016第三季度的财报(<a href="">10-Q</a>),可以从公司官网或者SEC（美国证监会）找到，如下图</p>
<p><img alt="" src="/image/16/tenQ.png" /></p>
<p>找到资产下的子分类，作为标签</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cash&#39;</span><span class="p">,</span><span class="s1">&#39;A/R&#39;</span><span class="p">,</span><span class="s1">&#39;Inventories&#39;</span><span class="p">,</span><span class="s1">&#39;GLOBF&#39;</span><span class="p">,</span><span class="s1">&#39;Prepaid&#39;</span><span class="p">,</span><span class="s1">&#39;Other Current&#39;</span><span class="p">,</span><span class="s1">&#39;Property&#39;</span><span class="p">,</span><span class="s1">&#39;Goodwill&#39;</span><span class="p">,</span><span class="s1">&#39;Investments&#39;</span><span class="p">,</span><span class="s1">&#39;Others&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>对应的值为</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">asset_items</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1258</span><span class="p">,</span><span class="mi">640</span><span class="p">,</span><span class="mi">772</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">161</span><span class="p">,</span><span class="mi">289</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">282</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>如果是common size balance sheet的话，我们以资产总和为100%，每个自分类表示为对应的百分比</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fracs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">each</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">asset_items</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">asset_items</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>绘制之前添加一组颜色，这组颜色对应每一个板块的颜色，可以自行选择</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">colors</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;#f26e6e&#39;</span><span class="p">,</span><span class="s1">&#39;#6e7ef2&#39;</span><span class="p">,</span><span class="s1">&#39;#6ed1f2&#39;</span><span class="p">,</span><span class="s1">&#39;#f29d6e&#39;</span><span class="p">,</span><span class="s1">&#39;#e1f26e&#39;</span><span class="p">,</span><span class="s1">&#39;#b7f26e&#39;</span><span class="p">,</span><span class="s1">&#39;#a46ef2&#39;</span><span class="p">,</span><span class="s1">&#39;#f2ec6e&#39;</span><span class="p">,</span><span class="s1">&#39;#6ef2a3&#39;</span><span class="p">,</span><span class="s1">&#39;#51a0aa&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>将比例设置为1，使最终效果为圆形</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">aspect</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>绘制</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">fracs</span><span class="p">,</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span><span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">,</span><span class="n">autopct</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>labels 使用我们预设的标签</li>
<li>color 使用我们预设的颜色</li>
<li>autopct 将数字标记在上面</li>
</ul>
<blockquote>
<p>>>> <strong>plt.show()</strong></p>
</blockquote>
<p><img alt="" src="/image/16/unpie.png" /></p>
<p>哇咧！下面的字叠在一起了，没法看了。该怎么办呢？我们可以使用之前学过的箭头来指向特别窄的扇区，但是还有另一种更简单粗暴的办法。</p>
<p><strong>转个角度</strong></p>
<p>我们添加初始角度</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">fracs</span><span class="p">,</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span><span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">,</span><span class="n">autopct</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">startangle</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>是不是好多了呢？</p>
<p><img alt="" src="/image/16/pie.png" /></p>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://finance.yahoo.com/quote/%5EGSPC?p=%5EGSPC">AMD-Yahoo Finance</a></li>
<li><a href="https://finance.yahoo.com/quote/%5EGSPC?p=%5EGSPC">S&amp;P500-Yahoo Finance</a></li>
<li><a href="https://www.sec.gov/cgi-bin/browse-edgar?action=getcompany&amp;CIK=0000002488&amp;type=10&amp;dateb=&amp;owner=exclude&amp;count=40">AMD 10Q - SEC EDGAR</a></li>
<li><a href="">百科词条</a></li>
</ul>
		
	</article>
	<div id="copyright"><a href="/copyright">&copy;著作权归作者所有</a></div>
	<hr>
    <div id="vc-main" data-access-token="11c8370248773a268137e6fb158a3884"></div>
    
    <div id="vc-feelback-main" data-access-token="bd6f14702ab835406654dbd001f2c721" data-display-type="4" ></div> 

                </div>
    
            </div>
            
            <footer>
                <ul class="share-group">
                    <li><a href="#">Jalapeno急速运转中</a></li>
                    <!--<li><a href="#">item</a></li>
                    <li><a href="#">item</a></li>
                    <li><a href="#">item</a></li>
                    <li><a href="#">item</a></li>--> 
                </ul>   
                <div class="copyright">
                    &copy ChenghaoQ;
                </div>

            </footer>
            
            
            <div class="back-to-top">
            	<span class="glyphicon glyphicon-chevron-up"></span>
            </div>
            <div id="closeBar">
                <span class="glyphicon glyphicon-remove"></span>
            </div>
        
        </div>
          
            
        
        
        
        
        
        
        <div id="sidebar">
            <div id="sidebar-menu">

               	<div id="home"><a href="/"><span class="glyphicon glyphicon-home"></span></a></div>
               	<ul>
               	    
<li id="catalog" class="item">
    <span class="glyphicon glyphicon-list-alt"></span>

</li>


               	    <li id="site-view" class="item">
                        <span class="glyphicon glyphicon-align-center"></span>
                    
                    </li>
               	 </ul>
                
            </div>
            <div id="sidebar-content" >
                

<div class="nav-content" id="catalog-content">
    <div class="nav-con-close">
        <span class='glyphicon glyphicon-chevron-right'></span>
    </div>
    <div class="nav-con-title">目录</div>
    <div class="inner-content">
        <div class="toc">
<ul>
<li><a href="#_1">工具准备</a></li>
<li><a href="#_2">散点图</a><ul>
<li><a href="#_3">简介</a></li>
<li><a href="#_4">实例</a></li>
</ul>
</li>
<li><a href="#_5">折线图</a><ul>
<li><a href="#_6">简介</a></li>
<li><a href="#1amd">实例1：AMD股票走势</a></li>
<li><a href="#2sp500">实例2:S&amp;P500走势</a></li>
<li><a href="#sp500amd">比较S&amp;P500与AMD</a></li>
</ul>
</li>
<li><a href="#_7">条形图</a><ul>
<li><a href="#_8">简介</a></li>
<li><a href="#amd4">条形图实例：AMD4个季度营业额</a></li>
<li><a href="#_9">条形图（横向）实例</a></li>
<li><a href="#_10">条形图对比实例</a></li>
</ul>
</li>
<li><a href="#_11">直方图</a><ul>
<li><a href="#_12">简介</a></li>
<li><a href="#amd">实例：AMD股价变化率正态分布</a></li>
</ul>
</li>
<li><a href="#_13">饼图</a><ul>
<li><a href="#amd_1">实例：AMD资产结构</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

    </div>
</div>

                    <div class="nav-content" id="site-view-content">
                    <div class="nav-con-close">
                        <span class='glyphicon glyphicon-chevron-right'></span>
                    </div>
                
                    <div class="inner-content">
                        <div class="selfie"><img src='/image/theme/Selfie.JPG'</div>
                        <div class="site-view-info">
                         
                            <p class="motto">你总有一个坚持下去的理由</p>
                
                            <h3 class="myself">老钱</h3>
                            
                            <ul class="posts-info">
                            </ul>
                            <div class="extern-links">
                               <ul>
                                   <li><a href="https://github.com/ChenghaoQ">Github</a></li>
                               <li><a>Wechat</a></li>            
                               </ul>
     
                            </div>
                
                    </div>
                </div>
            </div>
            </div>
        </div>
            
        </div>
		<script src="/static/js/jquery.js"></script>
        <!--<script src="/static/js/home.js"></script>
        <script src="/static/ijs/ihome.js"></script>-->
        <script type = "text/javascript">
        $(document).ready(function(){
            if($(window).width()>1024){
                temp = 'desktop';
                $.getScript( "/static/js/home.js" )
            }
            else
            {
                temp = 'mobile';
                $.getScript( "/static/ijs/ihome.js" )
            }
            console.log('reload');
            function refresher(){
                if($(window).width()>1024)
                    var status = 'desktop';
                else
                    var status = 'mobile';
                if (status!= temp)
                {
                    location=location;//refresh page
                    
                    temp = status;
                    
                }
                console.log(temp)
            };

            $(window).resize(refresher);
        });
        </script>

        
        

<!--         
        <script type="text/javascript" src="http://assets.vicomi.com/assets/widgets_static.js"></script>


        <script>
        (function() {
        var v = document.createElement('script'); v.async = true;
        v.src = "http://assets.vicomi.com/assets/widgets_static.js";
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(v, s);
        })();
        </script>  -->


        <!-- Carnival comments -->
        <!-- <script src="https://carnivalapp.io/sites/559/init.js"></script>
        <script>
            document.addEventListener("DOMContentLoaded", Carnival.init);
        </script> -->



    </body>





</html>